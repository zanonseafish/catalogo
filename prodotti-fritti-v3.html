<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catalogo Prodotti ZANON SEAFISH</title>
 <!-- Open Graph -->
 
<meta property="og:title" content="Catalogo Prodotti ZANON SEAFISH">
<meta property="og:description" content="Sfoglia il catalogo prodotti Zanon Seafish Ingros SRL">
<meta property="og:url" content="https://zanonseafish.github.io/catalogo/">
<meta property="og:type" content="website">

<meta property="og:image" content="https://zanonseafish.github.io/catalogo/images/og-cover1.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<meta name="twitter:card" content="summary_large_image">
<!-- end Open Graph -->
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fbfbf8;
      --ink:#111;
      --muted:#606060;
      --line:#e7e4dc;
      --brand:#0b5;
      --price:#0a6a2b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--ink)}

    /* Header */
    header{background:linear-gradient(180deg,#0b1620 0%, #0e1f2a 60%, #0e1f2a00 100%);color:#fff;padding:20px 12px 18px;text-align:center;position:relative}
    header .top{display:flex;flex-direction:column;align-items:center;gap:8px;max-width:1100px;margin:0 auto}
    header img.logo{height:60px;width:auto;display:block;margin:0 auto}
    header h1{font-family:"Playfair Display",serif;font-weight:600;letter-spacing:.02em;margin:0 0 2px 0;font-size:24px;line-height:1.15;word-break:break-word;overflow-wrap:anywhere}
    header .sub{opacity:.85;font-size:11.5px;margin-top:0}
    .tools{display:flex;justify-content:center;margin-top:8px}
    .search{max-width:480px;width:100%}
    .search input{width:100%;padding:10px;border-radius:999px;border:1px solid #ffffff40;background:#ffffff12;color:var(--brand);outline:none}
    .count{color:var(--brand);margin-top:8px;font-size:12px}

    /* Container compact */
    .container{max-width:1100px;margin:6px auto 14px;padding:0 10px}

    /* Slim list */
    .list{display:flex;flex-direction:column;gap:10px}
    .item{display:grid;grid-template-columns:84px 1fr 86px;gap:14px;align-items:center;background:rgba(255,255,255,.92);border:1px solid var(--line);border-radius:10px;padding:8px 10px;box-shadow:0 1px 6px rgba(0,0,0,.06);cursor:pointer;transition:transform .12s ease, box-shadow .12s ease}
    .item:hover{transform:translateY(-1px);box-shadow:0 4px 10px rgba(0,0,0,.06)}
    .thumb{width:84px;height:84px;border-radius:12px;overflow:hidden;background:#f1f1ed;border:1px solid var(--line)}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .info{min-width:0;padding-left:8px}
    .title{font-family:"Playfair Display",serif;font-weight:700;font-size:18px;letter-spacing:.02em;margin:0 0 3px 0;text-transform:uppercase}
    .desc{color:var(--muted);font-size:12px;line-height:1.3;margin:0 0 4px 0}
    .divider{height:1px;background:var(--line);margin:3px 0}
    .price{justify-self:end;align-self:end;color:var(--price);font-weight:700;font-size:16px}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;padding:20px;z-index:1000}
    .modal.open{display:flex}
    .modal-content{
      background:#fff;border-radius:12px;
      max-width:860px;width:min(96vw,860px);
      padding:20px;position:relative;
      max-height:90vh;overflow:hidden;
      box-shadow:0 10px 24px rgba(0,0,0,.35);
      display:flex;flex-direction:column;
    }
    .m-title{font-family:"Playfair Display",serif;margin:0 0 10px 0}
    .modal-footer{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-top:12px;flex:0 0 auto}
    .share-small{border:none;border-radius:18px;padding:8px 12px;font-size:.9rem;cursor:pointer;background:#111;color:#fff;box-shadow:0 4px 10px rgba(0,0,0,.3)}
    .close-btn{border:none;border-radius:18px;padding:8px 12px;font-size:.9rem;cursor:pointer;background:#eee;color:#111;box-shadow:0 2px 6px rgba(0,0,0,.15)}

    /* Gallery area grows and scrolls if needed */
    #mGallery{
      flex:1 1 auto;
      overflow:auto;
      display:grid;
      gap:12px;
      align-items:center;
      justify-items:center;
    }
    /* two columns if ci sono almeno 2 immagini */
    #mGallery:has(img:nth-child(2)){grid-template-columns:1fr 1fr;}
    #mGallery img{
      max-width:100%;
      height:auto;
      display:block;
      object-fit:contain;
    }

    /* Footer */
    .site-footer{max-width:1100px;margin:18px auto 24px;padding:0 10px;color:#444;font-size:12px}
    .site-rule{border:none;height:1px;background:#e5e2da;margin:6px 0 10px}
    .site-footer-inner{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .footer-logo{height:20px;width:auto}
    .foot-text{flex:1;min-width:240px}
    .foot-mail{font-size:12px;color:#0b5;text-decoration:none}

    /* Print-only footer (senza numeri pagina) */
    

    /* Responsive */
    @media (max-width:820px){
      header{padding:16px 10px 16px}
      header h1{font-size:22px}
      .item{grid-template-columns:76px 1fr 74px}
      .thumb{width:76px;height:76px;border-radius:10px}
      .title{font-size:16px}
      .price{font-size:15px}
    }
    @media (max-width:560px){
      header{padding:14px 8px 14px}
      header h1{font-size:20px}
      .item{grid-template-columns:66px 1fr;grid-template-rows:auto auto;gap:8px}
      .price{grid-column:2;justify-self:end}
    }

    /* Print */
    @media print{
      @page{size:A4;margin:14mm 12mm}
      body{background:#fff}
      header{background:none!important;color:#000!important;border-bottom:1px solid #ddd!important;padding:0 0 6mm}
      .sub{display:none!important}
      .tools, #count{display:none!important} /* Nascondi ricerca e contatore */
      .item{break-inside:avoid-page;page-break-inside:avoid;box-shadow:none;border-color:#ddd}
      .modal{display:none!important}
      .site-rule{background:#000;height:1px}
      .site-footer{color:#000}
      .foot-mail{color:#000;text-decoration:underline}

      /* Pi√® di pagina fisso su ogni pagina, senza numerazione */
      
      .print-footer .line{
        display:inline-flex;
        align-items:center;
        gap:6px;
      }
      .print-footer img{
        height:12px;
        width:auto;
        vertical-align:middle;
      }
      .print-footer .text{font-weight:600;}
    }

    .search input::placeholder{color:rgba(11,85,0,.7)}
  
/* Nascondi sempre il pi√® pagina a video */
.print-footer {
  display: none !important;
}

/* Mostra e posiziona solo in stampa */
@media print {
  .print-footer {
    display: block !important;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    text-align: center;
    font-size: 10px;
    color: #000;
    opacity: .95;
  }
  .print-footer .line {
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }
  .print-footer img {
    height: 12px;
    width: auto;
    vertical-align: middle;
  }
  .print-footer .text {
    font-weight: 600;
  }
}

</style>
</head>
<body>
  <header>
    <div class="top">
      <a href="index2.html" title="Torna alla selezione catalogo"><img class="logo" src="images/logo.png" alt="Zanon Seafish Ingros SRL" onerror="this.onerror=null;this.src='images/default1.jpg';"></a>
      <h1>Catalogo Prodotti ZANON SEAFISH</h1>
      <div class="sub">Clicca un elemento per i dettagli e la condivisione.</div>
      <div class="tools">
        <div class="search"><input id="searchBox" placeholder="Cerca prodotti‚Ä¶"></div>
      </div>
      <div id="count" class="count"></div>
    </div>
  </header>

  <!-- Pi√® di pagina per la stampa (senza numeri) -->
  <div class="print-footer" aria-hidden="true">
    <span class="line">
      <img src="images/logo.png" alt="Zanon Seafish">
      <span class="text">Zanon Seafish ‚Äì Catalogo Prodotti</span>
    </span>
  </div>

  <div class="container">
    <div id="list" class="list"></div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" aria-labelledby="mTitle">
      <h2 id="mTitle" class="m-title"></h2>
      <div id="mGallery"></div>
      <p id="mDesc" class="desc"></p>
      <p id="mFullDesc"></p>
      <p id="mPrice" class="price" style="margin-top:0"></p>
      <div class="modal-footer">
        <button id="shareBtn" class="share-small" title="Condividi" aria-label="Condividi">üì§ Condividi</button>
        <button id="closeBtn" class="close-btn" aria-label="Chiudi">Chiudi</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="site-footer">
    <hr class="site-rule">
    <div class="site-footer-inner">
      <img src="images/logo.png" alt="Zanon Seafish Ingros SRL" class="footer-logo" onerror="this.style.display='none'">
      <div class="foot-text">
        <strong>Zanon Seafish Ingros SRL</strong> ¬∑ P.IVA IT01654690278 ¬∑
        Sede legale: S. Croce 491, 30135 Venezia (VE) ¬∑
        Sede amm. e magazzini: Via Colombara 115/A, 30176 Marghera (VE) ¬∑
        Tel: 041 5382830 ¬∑ 041 3963095 ¬∑
        <a href="https://www.zanonseafish.it/" target="_blank" rel="noopener">www.zanonseafish.it</a> ¬∑
        <a href="mailto:info@zanonseafish.it">info@zanonseafish.it</a>
      </div>
      <a class="foot-mail" href="mailto:info@zanonseafish.it" title="Scrivi a info@zanonseafish.it">‚úâÔ∏è Contattaci</a>
    </div>
  </br>
  </footer>
</br>
 
  <script>
  // === DATI ===
  const PRODUCTS = [
  {id:"polpette-brasato",name:"Polpette di Brasato",price:14.00,shortDesc:"Conf. 2kg ‚Äì Polpette di brasato surgelate (40 pz da 50g)",fullDesc:"Polpette di brasato dal gusto autentico, preparate con carne di manzo selezionata. Ideali per secondi o buffet caldi.",images:["img2/polpette-brasato.jpg"]},
  {id:"polpette-baccala",name:"Polpette di Baccal√†",price:14.00,shortDesc:"Conf. 2kg ‚Äì Polpette di baccal√† surgelate (40 pz da 50g)",fullDesc:"Polpette morbide a base di baccal√† e patate. Perfette fritte o al forno come antipasto di mare.",images:["img2/polpette-baccala.jpg"]},
  {id:"polpette-tonno-cipolla",name:"Polpette di Tonno e Cipolla",price:14.00,shortDesc:"Conf. 2kg ‚Äì Polpette di tonno e cipolla (40 pz da 50g)",fullDesc:"Polpette di tonno con cipolla dolce e spezie mediterranee. Croccanti e profumate.",images:["img2/polpette-tonno-cipolla.jpg"]},
  {id:"polpette-pollo-speck",name:"Polpette di Pollo e Speck",price:12.00,shortDesc:"Conf. 2kg ‚Äì Polpette di pollo e speck (40 pz da 50g)",fullDesc:"Polpette dal sapore deciso con carne di pollo e speck affumicato. Ottime per aperitivi o secondi piatti.",images:["img2/polpette-pollo-speck.jpg"]},
  {id:"polpette-verdure",name:"Polpette di Verdure",price:12.00,shortDesc:"Conf. 2x2kg ‚Äì Polpette di verdure miste (40 pz da 50g)",fullDesc:"Polpette vegetariane con verdure fresche selezionate. Leggere e gustose, ideali per contorni o buffet.",images:["img2/polpette-verdure.png"]},

  {id:"arancini-mozzarella-prosciutto",name:"Arancini con Mozzarella e Prosciutto Prefritti",price:5.50,shortDesc:"Conf. 3kg ‚Äì Arancini con mozzarella e prosciutto prefritti",fullDesc:"Arancini di riso con cuore di mozzarella e prosciutto cotto. Pronti per la cottura.",images:["img2/arancini-prosciutto.png"]},
  {id:"arancini-spinaci",name:"Arancini agli Spinaci Prefritti",price:5.50,shortDesc:"Conf. 3kg ‚Äì Arancini agli spinaci prefritti",fullDesc:"Arancini di riso con ripieno cremoso agli spinaci e formaggio. Croccanti e saporiti.",images:["img2/arancini-spinaci.png"]},
  {id:"arrosticini-mare",name:"Arrosticini di Mare Panati (Totano Gigas)",price:8.30,shortDesc:"Conf. 4kg ‚Äì Arrosticini di mare panati",fullDesc:"Spiedini di totano gigas impanati e croccanti. Ideali fritti o al forno.",images:["img2/arrosticini-pesce-panati.png"]},
  {id:"alici-panato",name:"Alici Panate Croccanti",price:8.90,shortDesc:"Conf. 1kg ‚Äì Alici panate croccanti",fullDesc:"Filetti di alici panati e dorati. Ottimi per antipasti o secondi di mare.",images:["img2/alici-panati-croccanti.png"]},
  {id:"filetto-baccala-prezzemolo",name:"Filetto di Baccal√† Pastellato con Prezzemolo",price:11.90,shortDesc:"Conf. 5x1kg ‚Äì Filetti di baccal√† pastellati con prezzemolo",fullDesc:"Filetti di baccal√† teneri in pastella aromatica al prezzemolo. Croccanti e profumati.",images:["img2/filetti-baccala-pastellati.png"]},
  {id:"chele-granchio",name:"Chele di Granchio Panate",price:5.50,shortDesc:"Conf. 4x1kg ‚Äì Chele di granchio panate",fullDesc:"Chele di surimi al gusto di granchio, con panatura dorata e croccante. Pronte in pochi minuti.",images:["img2/chele-granchio-panate.jpg"]},
  {id:"fiori-zucca-mozzarella-alici",name:"Fiori di Zucca con Mozzarella e Alici Prefritti",price:9.30,shortDesc:"Conf. 5x1kg ‚Äì Fiori di zucca con mozzarella e alici",fullDesc:"Fiori di zucca ripieni di mozzarella e alici. Croccanti e saporiti, gi√† pronti da rigenerare.",images:["img2/fiori-zucca-mozz-alici.png"]},
  {id:"fiori-zucca-prosciutto-mozzarella",name:"Fiori di Zucca con Prosciutto e Mozzarella Prefritti",price:8.10,shortDesc:"Conf. 5x1kg ‚Äì Fiori di zucca con prosciutto e mozzarella",fullDesc:"Fiori di zucca con farcitura di prosciutto cotto e mozzarella filante. Doratura perfetta.",images:["img2/fiori-zucca-mozz-prosciutto.png"]},
  {id:"frittelle-gamberi-zucchine",name:"Frittelle di Gamberi e Zucchine",price:11.50,shortDesc:"Conf. 4x1kg ‚Äì Frittelle di gamberi e zucchine",fullDesc:"Frittelle di gamberi e zucchine in pastella croccante. Pronte in pochi minuti.",images:["img2/frittelle-gamberi-zucchine.png"]},
  {id:"gamberi-patata",name:"Gamberi Avvolti in Filo di Patata",price:14.00,shortDesc:"Conf. 5x1kg ‚Äì Gamberi avvolti in filo di patata",fullDesc:"Gamberi croccanti rivestiti di julienne di patata. Specialit√† gourmet.",images:["img2/gamberi-patata.jpg"]},
  {id:"mozzarelline-tartufo",name:"Mozzarelline Panate con Tartufo Prefritte",price:7.80,shortDesc:"Conf. 5x1kg ‚Äì Mozzarelline con tartufo prefritte",fullDesc:"Mozzarelline filanti aromatizzate al tartufo. Perfette per aperitivi.",images:["img2/mozzarelline-tartufo.png"]},
  {id:"olive-ascolane",name:"Olive Ascolane",price:5.40,shortDesc:"Conf. 4x2,500kg ‚Äì Olive ascolane ripiene di carne",fullDesc:"Olive verdi farcite con carne e panate. Croccanti e dorate in pochi minuti.",images:["img2/olive-ripiene-ascolana.png"]},
  {id:"olive-ascolane-prefritte",name:"Olive Ascolane Prefritte",price:5.90,shortDesc:"Conf. 5x1kg ‚Äì Olive ascolane prefritte",fullDesc:"Versione prefritta delle classiche olive ascolane, pronte da rigenerare in forno o friggitrice.",images:["img2/olive-ripiene-ascolana.png"]},
  {id:"panzerotti-mozzarella",name:"Panzerotti Mozzarella e Pomodoro Prefritti",price:5.40,shortDesc:"Conf. 5x1kg ‚Äì Panzerotti con mozzarella e pomodoro",fullDesc:"Mini panzerotti con ripieno di pomodoro e mozzarella filante. Perfetti come finger food.",images:["img2/panzerotti-mozzarella.png"]},
  {id:"polpette-melanzane",name:"Polpette di Melanzane, Mozzarella e Provola Affumicata",price:5.50,shortDesc:"Conf. 5x1kg ‚Äì Polpette di melanzane con mozzarella e provola affumicata",fullDesc:"Polpette vegetariane dal sapore intenso e consistenza morbida. Perfette per aperitivi e buffet.",images:["img2/polpette-melanzane.png"]},
  {id:"salvia-pastellata",name:"Salvia Pastellata Prefritta",price:11.50,shortDesc:"Conf. 4x1kg ‚Äì Foglie di salvia pastellate prefritte",fullDesc:"Foglie di salvia immerse in pastella leggera e croccante. Profumate e aromatiche.",images:["img2/salvia-pastellata.png"]},
  {id:"tris-verdure",name:"Tris di Verdure Pastellate Prefritte",price:5.20,shortDesc:"Conf. 5x1kg ‚Äì Tris di verdure pastellate prefritte",fullDesc:"Mix croccante di zucchine, carote e peperoni in pastella dorata. Perfette per contorni o antipasti.",images:["img2/tris-verdure.png"]}
];
  
  // Ordina alfabeticamente per id
  PRODUCTS.sort((a,b)=>a.id.localeCompare(b.id));

  const listEl=document.getElementById("list");
  const fmt=new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"});
  const countEl=document.getElementById("count");
  const q=document.getElementById("searchBox");
  const modal=document.getElementById("modal");
  const mTitle=document.getElementById("mTitle");
  const mDesc=document.getElementById("mDesc");
  const mFullDesc=document.getElementById("mFullDesc");
  const mPrice=document.getElementById("mPrice");
  const mGallery=document.getElementById("mGallery");
  const shareBtn=document.getElementById("shareBtn");
  const closeBtn=document.getElementById("closeBtn");
  let currentId=null;

  function rowTemplate(p){
    return `
    <div class="item" onclick="openModal('${p.id}')">
      <div class="thumb"><img loading="lazy" src="${p.images[0] || 'images/default1.jpg'}" alt="${p.name}" onerror="this.onerror=null;this.src='images/default1.jpg';"></div>
      <div class="info">
        <h3 class="title">${p.name}</h3>
        <p class="desc">${p.shortDesc||""}</p>
        <div class="divider"></div>
      </div>
      <div class="price">${fmt.format(p.price)}${p.unit || ""}</div>
    </div>`;
  }

  function render(list=PRODUCTS){
    listEl.innerHTML = list.length ? list.map(rowTemplate).join("") : '<div class="item">Nessun risultato</div>';
    countEl.textContent=list.length===PRODUCTS.length?`${list.length} prodotti`:`${list.length} risultati`;
  }

  function productAnchorUrl(id){
    const base=location.origin+location.pathname;
    return `${base}#${encodeURIComponent(id)}`;
  }

  async function shareProduct(id){
    const p=PRODUCTS.find(x=>x.id===id); if(!p) return;
    const imgUrl=new URL(p.images[0], location.href).href;
    const text=`${p.name} ‚Äì ${fmt.format(p.price)}\n${p.shortDesc||""}\n${productAnchorUrl(p.id)}`;
    try{
      if(navigator.canShare && window.File && window.Blob){
        const resp=await fetch(imgUrl,{mode:"cors"});
        const blob=await resp.blob();
        const file=new File([blob], `${p.id}.jpg`, {type: blob.type || "image/jpeg"});
        const data={title:p.name,text,files:[file]};
        if(navigator.canShare(data)){ await navigator.share(data); return; }
      }
      if(navigator.share){ await navigator.share({title:p.name,text:`${p.name} ‚Äì ${fmt.format(p.price)}\n${p.shortDesc||""}`,url:imgUrl}); return; }
    }catch(e){}
    try{ await navigator.clipboard.writeText(productAnchorUrl(p.id)); }catch(e){}
  }

  function adjustModalImages(){
    const content = document.querySelector('.modal-content');
    const gallery = document.getElementById('mGallery');
    if(!content || !gallery) return;
    const titleH = document.getElementById('mTitle')?.offsetHeight || 0;
    const descH  = document.getElementById('mDesc')?.offsetHeight || 0;
    const fullH  = document.getElementById('mFullDesc')?.offsetHeight || 0;
    const priceH = document.getElementById('mPrice')?.offsetHeight || 0;
    const footerH= document.querySelector('.modal-footer')?.offsetHeight || 0;
    const paddings = 40; // approx top+bottom padding inside modal-content
    const max = content.clientHeight - (titleH + descH + fullH + priceH + footerH + paddings);
    const imgs = gallery.querySelectorAll('img');
    imgs.forEach(img => { img.style.maxHeight = Math.max(120, max) + 'px'; });
  }

  window.openModal = function(id){
    const p=PRODUCTS.find(x=>x.id===id); if(!p) return;
    currentId=id;
    mTitle.textContent=p.name;
    mDesc.textContent=p.shortDesc||"";
    mFullDesc.textContent=p.fullDesc||"";
    mPrice.textContent=fmt.format(p.price)+(p.unit||"");
    const imgs=(p.images||[]).slice(0,2);
    mGallery.innerHTML=imgs.map(src=>`<img loading="lazy" src="${src||'images/default1.jpg'}" alt="${p.name}" onerror="this.onerror=null;this.src='images/default1.png';">`).join("");
    shareBtn.onclick=()=>shareProduct(currentId);
    modal.classList.add("open"); document.body.style.overflow="hidden"; closeBtn.focus();
    if(location.hash!=="#"+id) history.pushState({modal:true,id},"","#"+id);
    // after rendering, adjust sizes
    setTimeout(adjustModalImages, 0);
  }

  function closeModal(){
    if(!modal.classList.contains("open")) return;
    modal.classList.remove("open"); document.body.style.overflow="";
    currentId=null;
    if(location.hash) history.pushState("",document.title,location.pathname+location.search);
  }

  closeBtn.onclick=closeModal;
  modal.addEventListener("click",e=>{ if(e.target===modal) closeModal(); });
  window.addEventListener("keydown",e=>{ if(e.key==="Escape") closeModal(); });
  window.addEventListener("popstate",()=>{
    if(location.hash){
      const id=decodeURIComponent(location.hash.slice(1));
      if(!modal.classList.contains("open")) openModal(id);
    }else{
      if(modal.classList.contains("open")) modal.classList.remove("open"); document.body.style.overflow="";
    }
  });

  q.addEventListener("input",()=>{
    const term=q.value.trim().toLowerCase();
    if(!term){render(PRODUCTS);return;}
    const res=PRODUCTS.filter(p=>{
      const hay=[p.name||"",p.shortDesc||"",p.fullDesc||"",...(p.images||[]).map(x=>x.split('/').pop()||"")].join(" ").toLowerCase();
      return hay.includes(term);
    });
    render(res);
  });

  // Recompute image size on resize while modal open
  window.addEventListener('resize', ()=>{ if(modal.classList.contains('open')) adjustModalImages(); });

  render();
  if(location.hash){
    const id=decodeURIComponent(location.hash.slice(1));
    if(PRODUCTS.some(p=>p.id===id)) openModal(id);
  }
  </script>

<!-- === Zanon: Sidebar Cart + Prompt (additive, no layout changes) === -->
<style>
  .zanon-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:10000;display:none}
  .zanon-sidebar{position:fixed;top:0;right:0;height:100vh;width:min(92vw,420px);max-width:420px;background:#fff;
    box-shadow: -8px 0 24px rgba(0,0,0,.25);z-index:10001;transform:translateX(100%);transition:transform .25s ease;
    display:flex;flex-direction:column;}
  .zanon-sidebar.open{transform:translateX(0)}
  .zanon-head{padding:14px 16px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}
  .zanon-body{padding:12px 16px;overflow:auto;flex:1}
  .zanon-foot{padding:12px 16px;border-top:1px solid #eee;display:flex;gap:8px;justify-content:flex-end}
  .zanon-btn{border:none;border-radius:8px;padding:8px 12px;cursor:pointer;font-weight:600}
  .zanon-btn-primary{background:#0b5;color:#fff}
  .zanon-btn-ghost{background:#eee;color:#111}
  .zanon-line{font-size:14px;margin:4px 0}
  .zanon-floating{position:fixed;bottom:16px;right:16px;z-index:10002;background:#0b5;color:#fff;border:none;
    border-radius:999px;padding:10px 14px;font-weight:700;cursor:pointer;box-shadow:0 6px 16px rgba(0,0,0,.25)}
  .zanon-prompt{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:10003;background:rgba(0,0,0,.45)}
  .zanon-card{background:#fff;border-radius:10px;box-shadow:0 6px 16px rgba(0,0,0,.25);max-width:520px;width:min(92vw,520px);padding:16px 18px}
  .zanon-actions{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}
  .zanon-input{width:100%;padding:8px;border:1px solid #ddd;border-radius:8px;margin:4px 0 10px 0}
</style>

<!-- Floating cart button -->
<button id="zanonFloatCart" class="zanon-floating" type="button">üõí Carrello (0 articoli)</button>

<!-- Sidebar cart -->
<div id="zanonSidebar" class="zanon-sidebar" aria-hidden="true">
  <div class="zanon-head">
    <strong>Riepilogo Preordine</strong>
    <button id="zanonCloseSide" class="zanon-btn zanon-btn-ghost" type="button">Chiudi</button>
  </div>
  <div class="zanon-body">
    <div id="zanonCartList"></div>
    <label>Nome</label>
    <input id="zanonNome" class="zanon-input" />
    <label>Cognome</label>
    <input id="zanonCognome" class="zanon-input" />
    <label>Email</label>
    <input id="zanonEmail" type="email" class="zanon-input" />
  </div>
  <div class="zanon-foot">
    <button id="zanonSendWA" class="zanon-btn zanon-btn-ghost" type="button">üí¨ Invia via WhatsApp</button>
    <button id="zanonSendMail" class="zanon-btn zanon-btn-primary" type="button">üìß Invia via Email</button>
  </div>
</div>

<!-- Prompt other catalog -->
<div id="zanonPrompt" class="zanon-prompt" role="dialog" aria-modal="true">
  <div class="zanon-card">
    <h3 style="margin:0 0 6px 0">Vuoi consultare anche l‚Äôaltro catalogo?</h3>
    <p style="margin:0 0 8px 0">Puoi visitarlo ora mantenendo il carrello, oppure procedere direttamente al riepilogo.</p>
    <div class="zanon-actions">
      <button id="zanonGoOther" class="zanon-btn zanon-btn-ghost" type="button">üîÅ Vai all‚Äôaltro catalogo</button>
      <button id="zanonProceed" class="zanon-btn zanon-btn-primary" type="button">‚úâÔ∏è Procedi al riepilogo</button>
    </div>
  </div>
</div>

<script>
(function(){
  const CART_KEY='ZANON_CART_V2';
  const VIS_KEY='ZANON_VISITED_V2';
  const ADMIN_MAIL='info@zanonseafish.it';
  const ADMIN_TEL='393289092666'; // wa.me non accetta il '+'

  // Detect reload to reset cart only on browser refresh, not when navigating between pages
  try{
    const nav = performance.getEntriesByType && performance.getEntriesByType('navigation')[0];
    if(nav && nav.type==='reload'){
      localStorage.removeItem(CART_KEY);
    }
  }catch(e){}

  // Mark current catalog visited
  function markVisited(){
    const path=(location.pathname||'').toLowerCase();
    const v = JSON.parse(localStorage.getItem(VIS_KEY)||'{}');
    if(path.includes('fritti')) v.fritti=true; else v.conservati=true;
    localStorage.setItem(VIS_KEY, JSON.stringify(v));
  }
  function otherVisited(){
    const path=(location.pathname||'').toLowerCase();
    const v = JSON.parse(localStorage.getItem(VIS_KEY)||'{}');
    if(path.includes('fritti')) return !!v.conservati; else return !!v.fritti;
  }
  function otherCatalogHref(){
    const path=(location.pathname||'').toLowerCase();
    return path.includes('fritti') ? 'prodotti.html' : 'prodotti-fritti.html';
  }

  // Cart storage
  function getCart(){ try{return JSON.parse(localStorage.getItem(CART_KEY))||[]}catch(e){return []} }
  function setCart(arr){ localStorage.setItem(CART_KEY, JSON.stringify(arr||[])); syncUI(); }
  function qty(id){ const it=getCart().find(x=>x.id===id); return it?it.qty:0; }
  function total(){ return getCart().reduce((a,b)=>a+b.qty,0); }

  // UI refs
  const floatBtn = document.getElementById('zanonFloatCart');
  const side = document.getElementById('zanonSidebar');
  const closeSide = document.getElementById('zanonCloseSide');
  const listBox = document.getElementById('zanonCartList');
  const promptEl = document.getElementById('zanonPrompt');

  // Sync badges and lists
  function syncUI(){
    const n = total();
    if(floatBtn) floatBtn.textContent = n>0 ? `üõí Carrello (${n} articoli)` : `üõí Carrello (0 articoli)`;
    // Update fixed bottom button if present
    const btn = document.getElementById('cartBtn');
    if(btn) btn.textContent = n>0 ? `üõí Carrello (${n})` : 'üõí Carrello vuoto';

    // List in sidebar
    if(listBox){
      const items = getCart();
      listBox.innerHTML = items.length
        ? items.map(x=>`<div class="zanon-line">‚Ä¢ ${x.name} √ó ${x.qty}</div>`).join('')
        : '<div class="zanon-line">Carrello vuoto.</div>';
    }

    // Update in-list quantities if rowTemplate used counters
    (getCart().forEach || []).forEach;
    try{
      const items = getCart();
      items.forEach(x=>{
        const qEl = document.getElementById('q_'+x.id);
        if(qEl) qEl.textContent = x.qty;
      });
    }catch(e){}
  }

  // Add/Remove
  function inc(id){
    const p = (typeof PRODUCTS!=='undefined') ? PRODUCTS.find(x=>x.id===id) : null;
    if(!p) return;
    const cart = getCart();
    const it = cart.find(x=>x.id===id);
    if(it) it.qty++; else cart.push({id:p.id,name:p.name,qty:1});
    setCart(cart);
  }
  function dec(id){
    const cart = getCart();
    const it = cart.find(x=>x.id===id);
    if(!it) return;
    it.qty--;
    if(it.qty<=0){ setCart(cart.filter(x=>x.id!==id)); } else { setCart(cart); }
  }

  // Sidebar open/close
  function openSidebar(){ side && side.classList.add('open'); }
  function closeSidebar(){ side && side.classList.remove('open'); }

  // Flow for cart button
  function openCartUnified(){
    const n = total();
    if(n===0){ alert('Nessun articolo selezionato'); return; }
    if(!otherVisited()){
      promptEl.style.display='flex';
      document.getElementById('zanonGoOther').onclick=function(){
        promptEl.style.display='none';
        location.href = otherCatalogHref();
      };
      document.getElementById('zanonProceed').onclick=function(){
        promptEl.style.display='none';
        openSidebar();
      };
    }else{
      openSidebar();
    }
  }

  // Expose minimal API
  window.ZC = {inc, dec, qty, openCartUnified};

  // Override old handlers if any
  function rebindButtons(){
    const btn = document.getElementById('cartBtn');
    if(btn){ btn.onclick=function(e){ e.preventDefault(); openCartUnified(); }; }
    if(floatBtn){ floatBtn.onclick=function(){ openCartUnified(); }; }
    if(closeSide){ closeSide.onclick=function(){ closeSidebar(); }; }
  }

  // Dual send options
  function commonValidate(){
    const list = getCart();
    if(!list.length){ alert('Nessun articolo selezionato'); return null; }
    const nome = (document.getElementById('zanonNome').value||'').trim();
    const cognome = (document.getElementById('zanonCognome').value||'').trim();
    const email = (document.getElementById('zanonEmail').value||'').trim();
    if(!nome || !cognome || !email){ alert('Compila tutti i campi'); return null; }
    const lines = list.map(x=>`${x.name} √ó ${x.qty}`).join('%0A');
    const page = encodeURIComponent(location.href);
    const msg = `Gentile Zanon Seafish,%0A%0APreordine effettuato da:%0A${nome} ${cognome}%0AEmail: ${email}%0A%0AArticoli selezionati:%0A${lines}%0A%0APagina: ${page}%0A%0AGrazie.`;
    return {msg, list};
  }
  function sendMail(){
    const res = commonValidate(); if(!res) return;
    const subject = encodeURIComponent('Richiesta Preordine - Catalogo Zanon Seafish');
    location.href = `mailto:${ADMIN_MAIL}?subject=${subject}&body=${res.msg}`;
    alert("Riceverete una mail di risposta per conferma dell'ordine ricevuto. Grazie.");
    closeSidebar();
  }
  function sendWhatsApp(){
    const res = commonValidate(); if(!res) return;
    window.open('https://wa.me/'+ADMIN_TEL+'?text='+res.msg,'_blank');
  }

  function wireSenders(){
    const m=document.getElementById('zanonSendMail');
    const w=document.getElementById('zanonSendWA');
    if(m) m.onclick=sendMail;
    if(w) w.onclick=sendWhatsApp;
  }

  // Override rowTemplate to inject + / - and a live qty badge
  const fmt = new Intl.NumberFormat('it-IT', {style:'currency', currency:'EUR'});
  window.rowTemplate = function(p){
    const img0 = (p.images && p.images[0]) ? p.images[0] : 'images/default1.jpg';
    const q = qty(p.id) || 0;
    return `
      <div class="item" onclick="openModal('${p.id}')">
        <div class="thumb"><img loading="lazy" src="${img0}" alt="${p.name}" onerror="this.onerror=null;this.src='images/default1.jpg';"></div>
        <div class="info">
          <h3 class="title">${p.name}</h3>
          <p class="desc">${p.shortDesc||''}</p>
          <div class="divider"></div>
        </div>
        <div class="price">
          ${fmt.format(p.price)}${p.unit||''}<br>
          <button onclick="event.stopPropagation(); ZC.dec('${p.id}')">‚Äì</button>
          <span id="q_${p.id}" style="display:inline-block;min-width:22px;text-align:center">${q}</span>
          <button onclick="event.stopPropagation(); ZC.inc('${p.id}')">+</button>
        </div>
      </div>
    `;
  };

  // Boot
  document.addEventListener('DOMContentLoaded', function(){
    markVisited();
    rebindButtons();
    wireSenders();
    syncUI();
  });
})();
</script>
</body>
</html>
